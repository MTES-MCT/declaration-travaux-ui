(window["webpackJsonprieau-ui"]=window["webpackJsonprieau-ui"]||[]).push([[9],{455:function(n,e,r){"use strict";r.r(e);var t=r(77),o=r(78),u=r(80),i=r(79),c=r(81),s=r(571),a=r.n(s),f=r(588),d=function(n){function e(){return Object(t.a)(this,e),Object(u.a)(this,Object(i.a)(e).apply(this,arguments))}return Object(c.a)(e,n),Object(o.a)(e,[{key:"createAxiosInstance",value:function(n){var e=this,r=a.a.create(n);return r.interceptors.request.use((function(n){return new Promise((function(r,t){return e.updateToken(5).success((function(){n.headers.Authorization="Bearer "+e.token,r(n)})).error((function(){e.login()}))}))})),r}}],[{key:"axios",get:function(){return a.a}}]),e}(r.n(f).a),p=r(115),m=new d({url:Object(p.a)("REACT_APP_SSO_APP_URL"),realm:Object(p.a)("REACT_APP_SSO_APP_REALM"),clientId:Object(p.a)("REACT_APP_SSO_APP_CLIENT_ID")}),w=m.createAxiosInstance({baseURL:Object(p.a)("REACT_APP_API_URL"),responseType:"json",responseEncoding:"utf8",headers:{"Content-Type":"application/json;charset=UTF-8"},withCredentials:!0});var l={auth:{login:function(){return new Promise((function(n,e){return console.log("login"),m.init({onLoad:"login-required"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},isAuthenticated:function(){return new Promise((function(n,e){return m.init({onLoad:"check-sso"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},logout:function(){return new Promise((function(n,e){return m.logout().success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},getUser:function(){return new Promise((function(n,e){return m.loadUserInfo().success((function(e){return n({firstName:e.given_name,lastName:e.family_name,email:e.email})})).error((function(n){return e(new Error(n))}))}))},isDeposant:function(){return new Promise((function(n,e){return n(m.hasRealmRole("DEPOSANT"))}))},isInstructeur:function(){return new Promise((function(n,e){return n(m.hasRealmRole("INSTRUCTEUR"))}))},isBeta:function(){return new Promise((function(n,e){return n(m.hasRealmRole("BETA"))}))}},depots:{mesDepots:function(){return new Promise((function(n,e){return m.init({onLoad:"check-sso"}).success((function(e){return n(w.get("/dossiers").then((function(n){return n.data})))})).error((function(n){return e(new Error(n))}))}))},monDepot:function(n){return new Promise((function(e,r){return m.init({onLoad:"check-sso"}).success((function(r){return e(w.get("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},ajouterDepot:function(n){return new Promise((function(e,r){return m.init({onLoad:"check-sso"}).success((function(r){return e(w.post("/dossiers",n,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}))})).error((function(n){return r(new Error(n))}))}))},supprimerDepot:function(n){return new Promise((function(e,r){return m.init({onLoad:"check-sso"}).success((function(r){return e(w.delete("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},savePieceJointe:function(n,e,r){return new Promise((function(t,o){return m.init({onLoad:"check-sso"}).success((function(o){return t(w.post("/dossiers/".concat(n,"/piecesjointes/").concat(e),r,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}))})).error((function(n){return o(new Error(n))}))}))},lireFichier:function(n){return new Promise((function(e,r){return m.init({onLoad:"check-sso"}).success((function(r){return e(w.get("/fichiers/".concat(n),{responseType:"blob"}).then((function(n){return function(n){var e=n.headers["content-disposition"],r=n.headers["content-type"],t=/^attachment;filename=([\w]+[.]{1}[\w]+)$/i.exec(e);return{data:URL.createObjectURL(new Blob([n.data],{type:r})),nom:t[1],type:r}}(n)})))})).error((function(n){return r(new Error(n))}))}))}}};e.default=l}}]);
//# sourceMappingURL=9.f9d99699.chunk.js.map