(window["webpackJsonprieau-ui"]=window["webpackJsonprieau-ui"]||[]).push([[9],{455:function(n,e,r){"use strict";r.r(e);var t=r(77),o=r(78),c=r(80),u=r(79),i=r(81),s=r(571),a=r.n(s),f=r(588),p=function(n){function e(){return Object(t.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(i.a)(e,n),Object(o.a)(e,[{key:"createAxiosInstance",value:function(n){var e=this,r=a.a.create(n);return r.interceptors.request.use((function(n){return new Promise((function(r,t){return e.updateToken(5).success((function(){n.headers.Authorization="Bearer "+e.token,r(n)})).error((function(){e.login()}))}))})),r.interceptors.response.use((function(n){return n}),(function(n){return n.response?n.response.data.cause?Promise.reject(n.response.data.cause):Promise.reject(n.response.data):n.request?Promise.reject(n.request):Promise.reject(n)})),r}}],[{key:"axios",get:function(){return a.a}}]),e}(r.n(f).a),d=r(115),l=new p({url:Object(d.a)("REACT_APP_SSO_APP_URL"),realm:Object(d.a)("REACT_APP_SSO_APP_REALM"),clientId:Object(d.a)("REACT_APP_SSO_APP_CLIENT_ID")}),m=l.createAxiosInstance({baseURL:Object(d.a)("REACT_APP_API_URL"),responseType:"json",responseEncoding:"utf8",headers:{"Content-Type":"application/json;charset=UTF-8"},withCredentials:!0});var h={auth:{login:function(){return new Promise((function(n,e){return console.log("login"),l.init({onLoad:"login-required"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},isAuthenticated:function(){return new Promise((function(n,e){return l.init({onLoad:"check-sso"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},logout:function(){return new Promise((function(n,e){return l.logout().success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},getUser:function(){return new Promise((function(n,e){return l.loadUserInfo().success((function(e){return n({firstName:e.given_name,lastName:e.family_name,email:e.email})})).error((function(n){return e(new Error(n))}))}))},isDeposant:function(){return new Promise((function(n,e){return n(l.hasRealmRole("DEPOSANT"))}))},isInstructeur:function(){return new Promise((function(n,e){return n(l.hasRealmRole("INSTRUCTEUR"))}))},isBeta:function(){return new Promise((function(n,e){return n(l.hasRealmRole("BETA"))}))}},depots:{mesDepots:function(){return new Promise((function(n,e){return l.init({onLoad:"check-sso"}).success((function(e){return n(m.get("/dossiers").then((function(n){return n.data})))})).error((function(n){return e(new Error(n))}))}))},monDepot:function(n){return new Promise((function(e,r){return l.init({onLoad:"check-sso"}).success((function(r){return e(m.get("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},ajouterDepot:function(n){return new Promise((function(e,r){return l.init({onLoad:"check-sso"}).success((function(t){m.post("/dossiers",n,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}).then((function(n){return e(n)})).catch((function(n){return console.log("error=",JSON.stringify(n)),r(n)}))})).error((function(n){return r(new Error(n))}))}))},supprimerDepot:function(n){return new Promise((function(e,r){return l.init({onLoad:"check-sso"}).success((function(r){return e(m.delete("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},savePieceJointe:function(n,e,r){return new Promise((function(t,o){return l.init({onLoad:"check-sso"}).success((function(c){return t(m.post("/dossiers/".concat(n,"/piecesjointes/").concat(e),r,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}).catch((function(n){return console.log("error=",JSON.stringify(n)),o(n)})))})).error((function(n){return o(new Error(n))}))}))},lireFichier:function(n){return console.log("fichierId=",n),new Promise((function(e,r){return l.init({onLoad:"check-sso"}).success((function(t){return e(m.get("/fichiers/".concat(n),{responseType:"blob"}).then((function(n){return function(n){var e=n.headers["content-disposition"],r=n.headers["content-type"],t=/^attachment;filename=([\w- \xe9\xe8\xeb\xe0\xf9\u20ac\xea\xf4\xef\xee]+[.]{1}[\w]+)$/i.exec(e),o={data:URL.createObjectURL(new Blob([n.data],{type:r})),nom:t[1],type:r};return console.log("fileInfo=",o),o}(n)})).catch((function(n){return console.log("error=",JSON.stringify(n)),r(n)})))})).error((function(n){return r(new Error(n))}))}))}}};e.default=h}}]);
//# sourceMappingURL=9.79c560e1.chunk.js.map