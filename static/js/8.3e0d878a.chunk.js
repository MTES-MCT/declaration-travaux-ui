(this["webpackJsonprieau-ui"]=this["webpackJsonprieau-ui"]||[]).push([[8],{471:function(e,n,i){"use strict";i.r(n);var t=[{id:"jean.martin",email:"jean.martin@monfai.fr",firstName:"Jean",lastName:"Martin",profils:["DEPOSANT","BETA"]},{id:"jacques.dupont",email:"jacques.dupont@monfai.fr",firstName:"Jacques",lastName:"Dupont",profils:["INSTRUCTEUR"]},{id:"madame.le-maire",email:"madame.le-maire@monfai.fr",firstName:"Madame",lastName:"Le Maire",profils:["MAIRIE","BETA"],codePostal:["44100"]}],r=null,u=100;var o=[];function s(e){var n="";return e&&e.length>0&&(e.toUpperCase().includes("13406_PCMI")&&(n={id:"pcmi",label:"Permis de construire de maison individuelle"}),e.toUpperCase().includes("13703_DPMI")&&(n={id:"dp",label:"D\xe9claration pr\xe9alable"})),n}function a(e){return"Fichier CERFA ".concat(e.name," non reconnu. Seuls les fichiers nomm\xe9s cerfa_13406_PCMI.pdf ou cerfa_13703_DPMI.pdf sont reconnus.")}function c(e,n,i){var t=new FileReader;t.onload=function(){var r=t.result;sessionStorage.setItem(e.type.id+n,JSON.stringify({nom:i.name,type:i.type,size:i.size,data:URL.createObjectURL(new Blob([r],{type:i.type}))}))},t.readAsBinaryString(i)}var f={auth:{login:function(e){return new Promise((function(n,i){setTimeout((function(){return e?n(r=t.find((function(n){return n.id===e}))):i(new Error("Connexion impossible. User id inconnu."))}),u)}))},isAuthenticated:function(){return new Promise((function(e,n){setTimeout((function(){return e(null!==r)}),u)}))},logout:function(){return new Promise((function(e,n){setTimeout((function(){e(r=null)}),u)}))},getUser:function(){return new Promise((function(e,n){setTimeout((function(){return r?e(r):n(new Error("Pas d'utilisateur connect\xe9"))}),u)}))},isDeposant:function(){return new Promise((function(e,n){setTimeout((function(){return e(r.profils.includes("DEPOSANT"))}),u)}))},isMairie:function(){return new Promise((function(e,n){setTimeout((function(){return e(r.profils.includes("MAIRIE"))}),u)}))},isInstructeur:function(){return new Promise((function(e,n){setTimeout((function(){return e(r.profils.includes("INSTRUCTEUR"))}),u)}))},isBeta:function(){return new Promise((function(e,n){setTimeout((function(){return e(r.profils.includes("BETA"))}),u)}))}},dossiers:{listerDossiers:function(){return new Promise((function(e,n){setTimeout((function(){return e(o)}),(function(e){return n(e)}),u)}))},consulterDossier:function(e){return new Promise((function(n,i){setTimeout((function(){return n(o.find((function(n){return n.id===e})))}),u)}))},ajouterDossier:function(e){return new Promise((function(n,i){setTimeout((function(){var t=e.get("file"),u=s(t.name);if(""===u)return i(new Error(a(t)));var f={id:o.length.toString(),type:u,date:(new Date).toLocaleDateString(),statut:"DEPOSE",userId:r.id,cerfa:{type:u,numero:"0",fichierId:u+"0",DossierId:o.length.toString()},piecesAJoindre:["1"],piecesJointes:[]};return c(f,"0",t),o.push(f),n()}),u)}))},savePieceJointe:function(e,n,i){return new Promise((function(t,r){setTimeout((function(){var r=i.get("file");if(!function(e,n){if(!n.name)return!0;var i=s(n.name);return!e.includes("cerfa")||e===i.id+"0"}(n,r))throw new Error(a(r));var u=o.find((function(n){return n.id===e}));return c(u,n,r),u.piecesJointes.push({type:u.type,numero:n,fichierId:u.type.id+n,DossierId:e}),t()}),u)}))},lireFichier:function(e){return new Promise((function(n,i){setTimeout((function(){return n(JSON.parse(sessionStorage.getItem(e)))}),u)}))},qualifierDossier:function(e){return new Promise((function(n,i){setTimeout((function(){var i=o.find((function(n){return n.id===e}));return i.statut="QUALIFIE",n(i)}),u)}))}}};n.default=f}}]);
//# sourceMappingURL=8.3e0d878a.chunk.js.map