(this["webpackJsonprieau-ui"]=this["webpackJsonprieau-ui"]||[]).push([[9],{472:function(n,e,r){"use strict";r.r(e);var t=r(84),o=r(85),i=r(87),s=r(86),u=r(88),c=r(596),a=r.n(c),f=r(613),l=function(n){function e(){return Object(t.a)(this,e),Object(i.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(u.a)(e,n),Object(o.a)(e,[{key:"createAxiosInstance",value:function(n){var e=this,r=a.a.create(n);return r.interceptors.request.use((function(n){return new Promise((function(r,t){return e.updateToken(5).success((function(){n.headers.Authorization="Bearer "+e.token,r(n)})).error((function(){e.login()}))}))})),r.interceptors.response.use((function(n){return n}),(function(n){return n.response?n.response.data.cause?Promise.reject(n.response.data.cause):Promise.reject(n.response.data):n.request?Promise.reject(n.request):Promise.reject(n)})),r}}],[{key:"axios",get:function(){return a.a}}]),e}(r.n(f).a),d=r(119),h=new l({url:Object(d.a)("REACT_APP_SSO_APP_URL"),realm:Object(d.a)("REACT_APP_SSO_APP_REALM"),clientId:Object(d.a)("REACT_APP_SSO_APP_CLIENT_ID")}),p=h.createAxiosInstance({baseURL:Object(d.a)("REACT_APP_API_URL"),responseType:"json",responseEncoding:"utf8",headers:{"Content-Type":"application/json;charset=UTF-8"},withCredentials:!0});var m={auth:{login:function(){return new Promise((function(n,e){return console.log("login"),h.init({onLoad:"login-required"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},isAuthenticated:function(){return new Promise((function(n,e){return h.init({onLoad:"check-sso"}).success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},logout:function(){return new Promise((function(n,e){return h.logout().success((function(e){return n(e)})).error((function(n){return e(new Error(n))}))}))},getUser:function(){return new Promise((function(n,e){return h.loadUserInfo().success((function(e){return n({firstName:e.given_name,lastName:e.family_name,email:e.email})})).error((function(n){return e(new Error(n))}))}))},isDeposant:function(){return new Promise((function(n,e){return n(h.hasRealmRole("DEPOSANT"))}))},isMairie:function(){return new Promise((function(n,e){return n(h.hasRealmRole("MAIRIE"))}))},isInstructeur:function(){return new Promise((function(n,e){return n(h.hasRealmRole("INSTRUCTEUR"))}))},isBeta:function(){return new Promise((function(n,e){return n(h.hasRealmRole("BETA"))}))}},dossiers:{listerDossiers:function(){return new Promise((function(n,e){return h.init({onLoad:"check-sso"}).success((function(e){return n(p.get("/dossiers").then((function(n){return n.data})))})).error((function(n){return e(new Error(n))}))}))},consulterDossier:function(n){return new Promise((function(e,r){return h.init({onLoad:"check-sso"}).success((function(r){return e(p.get("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},ajouterDossier:function(n){return new Promise((function(e,r){return h.init({onLoad:"check-sso"}).success((function(t){p.post("/dossiers",n,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}).then((function(n){return e(n)})).catch((function(n){return console.log("error=",JSON.stringify(n)),r(n)}))})).error((function(n){return r(new Error(n))}))}))},supprimerDossier:function(n){return new Promise((function(e,r){return h.init({onLoad:"check-sso"}).success((function(r){return e(p.delete("/dossiers/".concat(n)).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))},savePieceJointe:function(n,e,r){return new Promise((function(t,o){return h.init({onLoad:"check-sso"}).success((function(i){return t(p.post("/dossiers/".concat(n,"/piecesjointes/").concat(e),r,{headers:{"content-type":"multipart/form-data;boundary=gc0p4Jq0M2Yt08jU534c0p"}}).catch((function(n){return console.log("error=",JSON.stringify(n)),o(n)})))})).error((function(n){return o(new Error(n))}))}))},lireFichier:function(n){return console.log("fichierId=",n),new Promise((function(e,r){return h.init({onLoad:"check-sso"}).success((function(t){return e(p.get("/fichiers/".concat(n),{responseType:"blob"}).then((function(n){return function(n){var e=n.headers["content-disposition"],r=n.headers["content-type"],t=/^attachment;filename=([\w- \xe9\xe8\xeb\xe0\xf9\u20ac\xea\xf4\xef\xee]+[.]{1}[\w]+)$/i.exec(e),o={data:URL.createObjectURL(new Blob([n.data],{type:r})),nom:t[1],type:r};return console.log("fileInfo=",o),o}(n)})).catch((function(n){return console.log("error=",JSON.stringify(n)),r(n)})))})).error((function(n){return r(new Error(n))}))}))},qualifierDossier:function(n){return new Promise((function(e,r){return h.init({onLoad:"check-sso"}).success((function(r){return console.log("id=",JSON.stringify(n)),e(p.post("/dossiers/".concat(n,"/qualifier")).then((function(n){return n.data})))})).error((function(n){return r(new Error(n))}))}))}}};e.default=m}}]);
//# sourceMappingURL=9.54009c9b.chunk.js.map